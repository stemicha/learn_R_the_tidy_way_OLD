<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>useful_packages___rstatix.knit</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R course - learn R the tidy way</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">R general</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="example1_growth_curves.html">Example 1: growth curves</a>
    </li>
    <li>
      <a href="example2_DIA_MS_data_analysis.html">Example 2: DIA-MS data analysis (part 1)</a>
    </li>
    <li>
      <a href="example3_DIA_MS_data_analysis_with_PECA.html">Example 3: DIA-MS data analysis (part 2) - ROPECA analysis of data</a>
    </li>
    <li>
      <a href="example4_protein_concentration_determination.html">Example 4: protein concentration determination (BCA assay)</a>
    </li>
    <li>
      <a href="example5_Germany_temperature_over_years.html">Example 5: plot temperature data to map</a>
    </li>
  </ul>
</li>
<li>
  <a href="useful_packages.html">useful packages</a>
</li>
<li>
  <a href="code_suggestions.html">coding hints/examples</a>
</li>
<li>
  <a href="code_snippets.html">code snippets</a>
</li>
<li>
  <a href="materials.html">Materials</a>
</li>
<li>
  <a href="books.html">Books</a>
</li>
<li>
  <a href="R_cheat_sheets.html">cheat sheets</a>
</li>
<li>
  <a href="mailto:stephan.michalik@uni-greifswald.de">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="rstatix-package" class="section level2">
<h2><code>rstatix</code> package</h2>
<p>Text here is from githib page of rstatix (<a
href="https://github.com/kassambara/rstatix/"
class="uri">https://github.com/kassambara/rstatix/</a>)</p>
<p><a href="https://github.com/kassambara/rstatix">rstatix</a> Provides
a simple and intuitive pipe-friendly framework, coherent with the
‘tidyverse’ design philosophy, for performing basic statistical tests,
including t-test, Wilcoxon test, ANOVA, Kruskal-Wallis and correlation
analyses.</p>
<p>The output of each test is automatically transformed into a tidy data
frame to facilitate visualization.</p>
<p>Additional functions are available for reshaping, reordering,
manipulating and visualizing correlation matrix. Functions are also
included to facilitate the analysis of factorial experiments, including
purely ‘within-Ss’ designs (repeated measures), purely ‘between-Ss’
designs, and mixed ‘within-and-between-Ss’ designs.</p>
<p>It’s also possible to compute several effect size metrics, including
“eta squared” for ANOVA, “Cohen’s d” for t-test and “Cramer’s V” for the
association between categorical variables. The package contains helper
functions for identifying univariate and multivariate outliers,
assessing normality and homogeneity of variances.</p>
<div id="key-functions" class="section level3">
<h3>Key functions</h3>
<div id="descriptive-statistics" class="section level4">
<h4>Descriptive statistics</h4>
<ul>
<li><code>get_summary_stats()</code>: Compute summary statistics for one
or multiple numeric variables. Can handle grouped data.</li>
<li><code>freq_table()</code>: Compute frequency table of categorical
variables.</li>
<li><code>get_mode()</code>: Compute the mode of a vector, that is the
most frequent values.</li>
<li><code>identify_outliers()</code>: Detect univariate outliers using
boxplot methods.</li>
<li><code>mahalanobis_distance()</code>: Compute Mahalanobis Distance
and Flag Multivariate Outliers.</li>
<li><code>shapiro_test()</code> and <code>mshapiro_test()</code>:
Univariate and multivariate Shapiro-Wilk normality test.</li>
</ul>
</div>
<div id="comparing-means" class="section level4">
<h4>Comparing means</h4>
<ul>
<li><code>t_test()</code>: perform one-sample, two-sample and pairwise
t-tests</li>
<li><code>wilcox_test()</code>: perform one-sample, two-sample and
pairwise Wilcoxon tests</li>
<li><code>sign_test()</code>: perform sign test to determine whether
there is a median difference between paired or matched
observations.</li>
<li><code>anova_test()</code>: an easy-to-use wrapper around
<code>car::Anova()</code> to perform different types of ANOVA tests,
including <strong>independent measures ANOVA</strong>, <strong>repeated
measures ANOVA</strong> and <strong>mixed ANOVA</strong>.</li>
<li><code>get_anova_test_table()</code>: extract ANOVA table from
<code>anova_test()</code> results. Can apply sphericity correction
automatically in the case of within-subject (repeated measures) designs.
<code>- welch_anova_test()</code>: Welch one-Way ANOVA test. A
pipe-frindly wrapper around the base function
<code>stats::oneway.test()</code>. This is is an alternative to the
standard one-way ANOVA in the situation where the homogeneity of
variance assumption is violated.</li>
<li><code>kruskal_test()</code>: perform kruskal-wallis rank sum
test</li>
<li><code>friedman_test()</code>: Provides a pipe-friendly framework to
perform a Friedman rank sum test, which is the non-parametric
alternative to the one-way repeated measures ANOVA test.</li>
<li><code>get_comparisons()</code>: Create a list of possible pairwise
comparisons between groups.</li>
<li><code>get_pvalue_position</code>: autocompute p-value positions for
plotting significance using ggplot2.</li>
</ul>
</div>
<div id="facilitating-anova-computation-in-r" class="section level4">
<h4>Facilitating ANOVA computation in R</h4>
<ul>
<li><code>factorial_design()</code>: build factorial design for easily
computing ANOVA using the <code>car::Anova()</code> function. This might
be very useful for repeated measures ANOVA, which is hard to set up with
the <code>car</code> package.</li>
<li><code>anova_summary()</code>: Create beautiful summary tables of
ANOVA test results obtained from either <code>car::Anova()</code> or
<code>stats::aov()</code>. The results include ANOVA table, generalized
effect size and some assumption checks, such as Mauchly’s test for
sphericity in the case of repeated measures ANOVA.</li>
</ul>
</div>
<div id="post-hoc-analyses" class="section level4">
<h4>Post-hoc analyses</h4>
<ul>
<li><code>tukey_hsd()</code>: performs tukey post-hoc tests. Can handle
different inputs formats: aov, lm, formula.</li>
<li><code>dunn_test()</code>: compute multiple pairwise comparisons
following Kruskal-Wallis test.</li>
<li><code>games_howell_test()</code>: Performs Games-Howell test, which
is used to compare all possible combinations of group differences when
the assumption of homogeneity of variances is violated.</li>
<li><code>emmeans_test()</code>: pipe-friendly wrapper arround
<code>emmeans</code> function to perform pairwise comparisons of
estimated marginal means. Useful for post-hoc analyses following up
ANOVA/ANCOVA tests.</li>
</ul>
</div>
<div id="comparing-proportions" class="section level4">
<h4>Comparing proportions</h4>
<ul>
<li><code>prop_test()</code>, <code>pairwise_prop_test()</code> and
<code>row_wise_prop_test()</code>. Performs one-sample and two-samples
z-test of proportions. Wrappers around the R base function
<code>prop.test()</code> but have the advantage of performing pairwise
and row-wise z-test of two proportions, the post-hoc tests following a
significant chi-square test of homogeneity for 2xc and rx2 contingency
tables.</li>
<li><code>fisher_test()</code>, <code>pairwise_fisher_test()</code> and
<code>row_wise_fisher_test()</code>: Fisher’s exact test for count data.
Wrappers around the R base function <code>fisher.test()</code> but have
the advantage of performing pairwise and row-wise fisher tests, the
post-hoc tests following a significant chi-square test of homogeneity
for 2xc and rx2 contingency tables.</li>
<li><code>chisq_test()</code>, <code>pairwise_chisq_gof_test()</code>,
<code>pairwise_chisq_test_against_p()</code>: Performs chi-squared
tests, including goodness-of-fit, homogeneity and independence
tests.</li>
<li><code>binom_test()</code>, <code>pairwise_binom_test()</code>,
<code>pairwise_binom_test_against_p()</code>: Performs exact binomial
test and pairwise comparisons following a significant exact multinomial
test. Alternative to the chi-square test of goodness-of-fit-test when
the sample.</li>
<li><code>multinom_test()</code>: performs an exact multinomial test.
Alternative to the chi-square test of goodness-of-fit-test when the
sample size is small.</li>
<li><code>mcnemar_test()</code>: performs McNemar chi-squared test to
compare paired proportions. Provides pairwise comparisons between
multiple groups.</li>
<li><code>cochran_qtest()</code>: extension of the McNemar Chi-squared
test for comparing more than two paired proportions.</li>
<li><code>prop_trend_test()</code>: Performs chi-squared test for trend
in proportion. This test is also known as Cochran-Armitage trend
test.</li>
</ul>
</div>
<div id="comparing-variances" class="section level4">
<h4>Comparing variances</h4>
<ul>
<li><code>levene_test()</code>: Pipe-friendly framework to easily
compute Levene’s test for homogeneity of variance across groups. Handles
grouped data.</li>
<li><code>box_m()</code>: Box’s M-test for homogeneity of covariance
matrices</li>
</ul>
</div>
<div id="effect-size" class="section level4">
<h4>Effect Size</h4>
<ul>
<li><code>cohens_d()</code>: Compute cohen’s d measure of effect size
for t-tests.</li>
<li><code>wilcox_effsize()</code>: Compute Wilcoxon effect size
(r).</li>
<li><code>eta_squared()</code> and <code>partial_eta_squared()</code>:
Compute effect size for ANOVA.</li>
<li><code>kruskal_effsize()</code>: Compute the effect size for
Kruskal-Wallis test as the eta squared based on the H-statistic.</li>
<li><code>friedman_effsize()</code>: Compute the effect size of Friedman
test using the Kendall’s W value.</li>
<li><code>cramer_v()</code>: Compute Cramer’s V, which measures the
strength of the association between categorical variables.</li>
</ul>
</div>
<div id="correlation-analysis" class="section level4">
<h4>Correlation analysis</h4>
<p><strong>Computing correlation</strong>:</p>
<ul>
<li><code>cor_test()</code>: correlation test between two or more
variables using Pearson, Spearman or Kendall methods.</li>
<li><code>cor_mat()</code>: compute correlation matrix with p-values.
Returns a data frame containing the matrix of the correlation
coefficients. The output has an attribute named “pvalue”, which contains
the matrix of the correlation test p-values.</li>
<li><code>cor_get_pval()</code>: extract a correlation matrix p-values
from an object of class <code>cor_mat()</code>.</li>
<li><code>cor_pmat()</code>: compute the correlation matrix, but returns
only the p-values of the correlation tests.</li>
<li><code>as_cor_mat()</code>: convert a <code>cor_test</code> object
into a correlation matrix format.</li>
</ul>
<p><strong>Reshaping correlation matrix</strong>:</p>
<ul>
<li><code>cor_reorder()</code>: reorder correlation matrix, according to
the coefficients, using the hierarchical clustering method.</li>
<li><code>cor_gather()</code>: takes a correlation matrix and collapses
(or melt) it into long format data frame (paired list)</li>
<li><code>cor_spread()</code>: spread a long correlation data frame into
wide format (correlation matrix).</li>
</ul>
<p><strong>Subsetting correlation matrix</strong>:</p>
<ul>
<li><code>cor_select()</code>: subset a correlation matrix by selecting
variables of interest.</li>
<li><code>pull_triangle()</code>, <code>pull_upper_triangle()</code>,
<code>pull_lower_triangle()</code>: pull upper and lower triangular
parts of a (correlation) matrix.</li>
<li><code>replace_triangle()</code>,
<code>replace_upper_triangle()</code>,
<code>replace_lower_triangle()</code>: replace upper and lower
triangular parts of a (correlation) matrix.</li>
</ul>
<p><strong>Visualizing correlation matrix</strong>:</p>
<ul>
<li><code>cor_as_symbols()</code>: replaces the correlation
coefficients, in a matrix, by symbols according to the value.</li>
<li><code>cor_plot()</code>: visualize correlation matrix using base
plot.</li>
<li><code>cor_mark_significant()</code>: add significance levels to a
correlation matrix.</li>
</ul>
</div>
<div id="adjusting-p-values-formatting-and-adding-significance-symbols"
class="section level4">
<h4>Adjusting p-values, formatting and adding significance symbols</h4>
<ul>
<li><code>adjust_pvalue()</code>: add an adjusted p-values column to a
data frame containing statistical test p-values</li>
<li><code>add_significance()</code>: add a column containing the p-value
significance level</li>
<li><code>p_round(), p_format(), p_mark_significant()</code>: rounding
and formatting p-values</li>
</ul>
</div>
<div id="extract-information-from-statistical-tests"
class="section level4">
<h4>Extract information from statistical tests</h4>
<p>Extract information from statistical test results. Useful for
labelling plots with test outputs.</p>
<ul>
<li><code>get_pwc_label()</code>: Extract label from pairwise
comparisons.</li>
<li><code>get_test_label()</code>: Extract label from statistical
tests.</li>
<li><code>create_test_label()</code>: Create labels from user specified
test results.</li>
</ul>
</div>
<div id="others" class="section level4">
<h4>Others</h4>
<ul>
<li><code>doo()</code>: alternative to dplyr::do for doing anything.
Technically it uses <code>nest() + mutate() + map()</code> to apply
arbitrary computation to a grouped data frame.</li>
<li><code>sample_n_by()</code>: sample n rows by group from a table</li>
<li><code>convert_as_factor(), set_ref_level(), reorder_levels()</code>:
Provides pipe-friendly functions to convert simultaneously multiple
variables into a factor variable.</li>
<li><code>make_clean_names()</code>: Pipe-friendly function to make
syntactically valid column names (for input data frame) or names (for
input vector).</li>
<li><code>counts_to_cases()</code>: converts a contingency table or a
data frame of counts into a data frame of individual observations.</li>
</ul>
</div>
</div>
<div id="installation-and-loading" class="section level3">
<h3>Installation and loading</h3>
<ul>
<li>Install the latest developmental version from <a
href="https://github.com/kassambara/rstatix">GitHub</a> as follow:</li>
</ul>
<pre class="r"><code>if(!require(devtools)) install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;kassambara/rstatix&quot;)</code></pre>
<ul>
<li>Or install from <a
href="https://cran.r-project.org/package=ggpubr">CRAN</a> as
follow:</li>
</ul>
<pre class="r"><code>install.packages(&quot;rstatix&quot;)</code></pre>
<ul>
<li>Loading packages</li>
</ul>
<pre class="r"><code>library(rstatix)  </code></pre>
<pre><code>## 
## Attaching package: &#39;rstatix&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:IRanges&#39;:
## 
##     desc</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>library(ggpubr)  # For easy data-visualization</code></pre>
</div>
<div id="descriptive-statistics-1" class="section level3">
<h3>Descriptive statistics</h3>
<pre class="r"><code># Summary statistics of some selected variables
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
iris %&gt;% 
  get_summary_stats(Sepal.Length, Sepal.Width, type = &quot;common&quot;)</code></pre>
<pre><code>## # A tibble: 2 × 10
##   variable         n   min   max median   iqr  mean    sd    se    ci
##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Sepal.Length   150   4.3   7.9    5.8   1.3  5.84 0.828 0.068 0.134
## 2 Sepal.Width    150   2     4.4    3     0.5  3.06 0.436 0.036 0.07</code></pre>
<pre class="r"><code># Whole data frame
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
iris %&gt;% get_summary_stats(type = &quot;common&quot;)</code></pre>
<pre><code>## # A tibble: 4 × 10
##   variable         n   min   max median   iqr  mean    sd    se    ci
##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Petal.Length   150   1     6.9   4.35   3.5  3.76 1.76  0.144 0.285
## 2 Petal.Width    150   0.1   2.5   1.3    1.5  1.20 0.762 0.062 0.123
## 3 Sepal.Length   150   4.3   7.9   5.8    1.3  5.84 0.828 0.068 0.134
## 4 Sepal.Width    150   2     4.4   3      0.5  3.06 0.436 0.036 0.07</code></pre>
<pre class="r"><code># Grouped data
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
iris %&gt;%
  group_by(Species) %&gt;% 
  get_summary_stats(Sepal.Length, type = &quot;mean_sd&quot;)</code></pre>
<pre><code>## # A tibble: 3 × 5
##   Species    variable         n  mean    sd
##   &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 setosa     Sepal.Length    50  5.01 0.352
## 2 versicolor Sepal.Length    50  5.94 0.516
## 3 virginica  Sepal.Length    50  6.59 0.636</code></pre>
</div>
<div id="comparing-two-means" class="section level3">
<h3>Comparing two means</h3>
<p>To compare the means of two groups, you can use either the function
<code>t_test()</code> (parametric) or <code>wilcox_test()</code>
(non-parametric). In the following example the t-test will be
illustrated.</p>
<div id="data" class="section level4">
<h4>Data</h4>
<p>Preparing the demo data set:</p>
<pre class="r"><code>df &lt;- ToothGrowth
df$dose &lt;- as.factor(df$dose)
head(df)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
</div>
<div id="one-sample-test" class="section level4">
<h4>One-sample test</h4>
<p>The one-sample test is used to compare the mean of one sample to a
known standard (or theoretical / hypothetical) mean
(<code>mu</code>).</p>
<pre class="r"><code>df %&gt;% t_test(len ~ 1, mu = 0)</code></pre>
<pre><code>## # A tibble: 1 × 7
##   .y.   group1 group2         n statistic    df        p
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1 len   1      null model    60      19.1    59 6.94e-27</code></pre>
<pre class="r"><code># One-sample test of each dose level
df %&gt;% 
  group_by(dose) %&gt;%
  t_test(len ~ 1, mu = 0)</code></pre>
<pre><code>## # A tibble: 3 × 8
##   dose  .y.   group1 group2         n statistic    df        p
## * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1 0.5   len   1      null model    20      10.5    19 2.24e- 9
## 2 1     len   1      null model    20      20.0    19 3.22e-14
## 3 2     len   1      null model    20      30.9    19 1.03e-17</code></pre>
</div>
<div id="compare-two-independent-groups" class="section level4">
<h4>Compare two independent groups</h4>
<ul>
<li>Create a simple box plot with p-values:</li>
</ul>
<pre class="r"><code># T-test
stat.test &lt;- df %&gt;% 
  t_test(len ~ supp, paired = FALSE) 
stat.test</code></pre>
<pre><code>## # A tibble: 1 × 8
##   .y.   group1 group2    n1    n2 statistic    df      p
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 len   OJ     VC        30    30      1.92  55.3 0.0606</code></pre>
<pre class="r"><code># Create a box plot
p &lt;- ggboxplot(
  df, x = &quot;supp&quot;, y = &quot;len&quot;, 
  color = &quot;supp&quot;, palette = &quot;jco&quot;, ylim = c(0,40)
  )
# Add the p-value manually
p + stat_pvalue_manual(stat.test, label = &quot;p&quot;, y.position = 35)</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/unpaired-two-sample-t-test-1.png" width="336" /></p>
<ul>
<li>Customize labels using <a
href="https://github.com/tidyverse/glue">glue expression</a>:</li>
</ul>
<pre class="r"><code>p +stat_pvalue_manual(stat.test, label = &quot;T-test, p = {p}&quot;, 
                      y.position = 36)</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/custoize-p-value-labels-1.png" width="336" /></p>
<ul>
<li>Grouped data: compare supp levels after grouping the data by
“dose”</li>
</ul>
<pre class="r"><code># Statistical test
stat.test &lt;- df %&gt;%
  group_by(dose) %&gt;%
  t_test(len ~ supp) %&gt;%
  adjust_pvalue() %&gt;%
  add_significance(&quot;p.adj&quot;)
stat.test</code></pre>
<pre><code>## # A tibble: 3 × 11
##   dose  .y.   group1 group2    n1    n2 statistic    df       p   p.adj p.adj.…¹
##   &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   
## 1 0.5   len   OJ     VC        10    10    3.17    15.0 0.00636 0.0127  *       
## 2 1     len   OJ     VC        10    10    4.03    15.4 0.00104 0.00312 **      
## 3 2     len   OJ     VC        10    10   -0.0461  14.0 0.964   0.964   ns      
## # … with abbreviated variable name ¹​p.adj.signif</code></pre>
<pre class="r"><code># Visualization
ggboxplot(
  df, x = &quot;supp&quot;, y = &quot;len&quot;,
  color = &quot;supp&quot;, palette = &quot;jco&quot;, facet.by = &quot;dose&quot;,
  ylim = c(0, 40)
  ) +
  stat_pvalue_manual(stat.test, label = &quot;p.adj&quot;, y.position = 35)</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/grouped-two-sample-t-test-1.png" width="576" /></p>
</div>
<div id="compare-paired-samples" class="section level4">
<h4>Compare paired samples</h4>
<pre class="r"><code># T-test
stat.test &lt;- df %&gt;% 
  t_test(len ~ supp, paired = TRUE) 
stat.test</code></pre>
<pre><code>## # A tibble: 1 × 8
##   .y.   group1 group2    n1    n2 statistic    df       p
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 len   OJ     VC        30    30      3.30    29 0.00255</code></pre>
<pre class="r"><code># Box plot
p &lt;- ggpaired(
  df, x = &quot;supp&quot;, y = &quot;len&quot;, color = &quot;supp&quot;, palette = &quot;jco&quot;, 
  line.color = &quot;gray&quot;, line.size = 0.4, ylim = c(0, 40)
  )
p + stat_pvalue_manual(stat.test, label = &quot;p&quot;, y.position = 36)</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/paired-t-test-1.png" width="336" /></p>
</div>
<div id="multiple-pairwise-comparisons" class="section level4">
<h4>Multiple pairwise comparisons</h4>
<ul>
<li>Pairwise comparisons: if the grouping variable contains more than
two categories, a pairwise comparison is automatically performed.</li>
</ul>
<pre class="r"><code># Pairwise t-test
pairwise.test &lt;- df %&gt;% t_test(len ~ dose)
pairwise.test</code></pre>
<pre><code>## # A tibble: 3 × 10
##   .y.   group1 group2    n1    n2 statistic    df        p    p.adj p.adj.signif
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
## 1 len   0.5    1         20    20     -6.48  38.0 1.27e- 7 2.54e- 7 ****        
## 2 len   0.5    2         20    20    -11.8   36.9 4.4 e-14 1.32e-13 ****        
## 3 len   1      2         20    20     -4.90  37.1 1.91e- 5 1.91e- 5 ****</code></pre>
<pre class="r"><code># Box plot
ggboxplot(df, x = &quot;dose&quot;, y = &quot;len&quot;)+
  stat_pvalue_manual(
    pairwise.test, label = &quot;p.adj&quot;, 
    y.position = c(29, 35, 39)
    )</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/pairwise-comparisons-1.png" width="336" /></p>
<ul>
<li>Multiple pairwise comparisons against reference group: each level is
compared to the ref group</li>
</ul>
<pre class="r"><code># Comparison against reference group
#::::::::::::::::::::::::::::::::::::::::
# T-test: each level is compared to the ref group
stat.test &lt;- df %&gt;% t_test(len ~ dose, ref.group = &quot;0.5&quot;)
stat.test</code></pre>
<pre><code>## # A tibble: 2 × 10
##   .y.   group1 group2    n1    n2 statistic    df        p    p.adj p.adj.signif
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
## 1 len   0.5    1         20    20     -6.48  38.0 1.27e- 7 1.27e- 7 ****        
## 2 len   0.5    2         20    20    -11.8   36.9 4.4 e-14 8.8 e-14 ****</code></pre>
<pre class="r"><code># Box plot
ggboxplot(df, x = &quot;dose&quot;, y = &quot;len&quot;, ylim = c(0, 40)) +
  stat_pvalue_manual(
    stat.test, label = &quot;p.adj.signif&quot;, 
    y.position = c(29, 35)
    )</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/comaprison-against-reference-group-1.png" width="336" /></p>
<pre class="r"><code># Remove bracket
ggboxplot(df, x = &quot;dose&quot;, y = &quot;len&quot;, ylim = c(0, 40)) +
  stat_pvalue_manual(
    stat.test, label = &quot;p.adj.signif&quot;, 
    y.position = c(29, 35),
    remove.bracket = TRUE
    )</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/comaprison-against-reference-group-2.png" width="336" /></p>
<ul>
<li>Multiple pairwise comparisons against all (base-mean): Comparison of
each group against base-mean.</li>
</ul>
<pre class="r"><code># T-test
stat.test &lt;- df %&gt;% t_test(len ~ dose, ref.group = &quot;all&quot;)
stat.test</code></pre>
<pre><code>## # A tibble: 3 × 10
##   .y.   group1 group2    n1    n2 statistic    df           p      p.adj p.adj…¹
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  
## 1 len   all    0.5       60    20     5.82   56.4 0.00000029  0.00000087 ****   
## 2 len   all    1         60    20    -0.660  57.5 0.512       0.512      ns     
## 3 len   all    2         60    20    -5.61   66.5 0.000000425 0.00000087 ****   
## # … with abbreviated variable name ¹​p.adj.signif</code></pre>
<pre class="r"><code># Box plot with horizontal mean line
ggboxplot(df, x = &quot;dose&quot;, y = &quot;len&quot;) +
  stat_pvalue_manual(
    stat.test, label = &quot;p.adj.signif&quot;, 
    y.position = 35,
    remove.bracket = TRUE
    ) +
  geom_hline(yintercept = mean(df$len), linetype = 2)</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/comparison-against-base-mean-1.png" width="336" /></p>
</div>
</div>
<div id="anova-test" class="section level3">
<h3>ANOVA test</h3>
<pre class="r"><code># One-way ANOVA test
#:::::::::::::::::::::::::::::::::::::::::
df %&gt;% anova_test(len ~ dose)</code></pre>
<pre><code>## Coefficient covariances computed by hccm()</code></pre>
<pre><code>## ANOVA Table (type II tests)
## 
##   Effect DFn DFd    F        p p&lt;.05   ges
## 1   dose   2  57 67.4 9.53e-16     * 0.703</code></pre>
<pre class="r"><code># Two-way ANOVA test
#:::::::::::::::::::::::::::::::::::::::::
df %&gt;% anova_test(len ~ supp*dose)</code></pre>
<pre><code>## Coefficient covariances computed by hccm()</code></pre>
<pre><code>## ANOVA Table (type II tests)
## 
##      Effect DFn DFd     F        p p&lt;.05   ges
## 1      supp   1  54 15.57 2.31e-04     * 0.224
## 2      dose   2  54 92.00 4.05e-18     * 0.773
## 3 supp:dose   2  54  4.11 2.20e-02     * 0.132</code></pre>
<pre class="r"><code># Two-way repeated measures ANOVA
#:::::::::::::::::::::::::::::::::::::::::
df$id &lt;- rep(1:10, 6) # Add individuals id
# Use formula
# df %&gt;% anova_test(len ~ supp*dose + Error(id/(supp*dose)))
# or use character vector
df %&gt;% anova_test(dv = len, wid = id, within = c(supp, dose))</code></pre>
<pre><code>## ANOVA Table (type III tests)
## 
## $ANOVA
##      Effect DFn DFd      F        p p&lt;.05   ges
## 1      supp   1   9  34.87 2.28e-04     * 0.224
## 2      dose   2  18 106.47 1.06e-10     * 0.773
## 3 supp:dose   2  18   2.53 1.07e-01       0.132
## 
## $`Mauchly&#39;s Test for Sphericity`
##      Effect     W     p p&lt;.05
## 1      dose 0.807 0.425      
## 2 supp:dose 0.934 0.761      
## 
## $`Sphericity Corrections`
##      Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05  HFe      DF[HF]    p[HF]
## 1      dose 0.838 1.68, 15.09 2.79e-09         * 1.01 2.02, 18.15 1.06e-10
## 2 supp:dose 0.938 1.88, 16.88 1.12e-01           1.18 2.35, 21.17 1.07e-01
##   p[HF]&lt;.05
## 1         *
## 2</code></pre>
<pre class="r"><code># Use model as arguments
#:::::::::::::::::::::::::::::::::::::::::
.my.model &lt;- lm(yield ~ block + N*P*K, npk)
anova_test(.my.model)</code></pre>
<pre><code>## Coefficient covariances computed by hccm()</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## ANOVA Table (type II tests)
## 
##   Effect DFn DFd      F     p p&lt;.05   ges
## 1  block   4  12  4.959 0.014     * 0.623
## 2      N   1  12 12.259 0.004     * 0.505
## 3      P   1  12  0.544 0.475       0.043
## 4      K   1  12  6.166 0.029     * 0.339
## 5    N:P   1  12  1.378 0.263       0.103
## 6    N:K   1  12  2.146 0.169       0.152
## 7    P:K   1  12  0.031 0.863       0.003
## 8  N:P:K   0  12     NA    NA  &lt;NA&gt;    NA</code></pre>
</div>
<div id="correlation-tests" class="section level3">
<h3>Correlation tests</h3>
<pre class="r"><code># Data preparation
mydata &lt;- mtcars %&gt;% 
  select(mpg, disp, hp, drat, wt, qsec)
head(mydata, 3)</code></pre>
<pre><code>##                mpg disp  hp drat   wt qsec
## Mazda RX4     21.0  160 110 3.90 2.62 16.5
## Mazda RX4 Wag 21.0  160 110 3.90 2.88 17.0
## Datsun 710    22.8  108  93 3.85 2.32 18.6</code></pre>
<pre class="r"><code># Correlation test between two variables
mydata %&gt;% cor_test(wt, mpg, method = &quot;pearson&quot;)</code></pre>
<pre><code>## # A tibble: 1 × 8
##   var1  var2    cor statistic        p conf.low conf.high method 
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
## 1 wt    mpg   -0.87     -9.56 1.29e-10   -0.934    -0.744 Pearson</code></pre>
<pre class="r"><code># Correlation of one variable against all
mydata %&gt;% cor_test(mpg, method = &quot;pearson&quot;)</code></pre>
<pre><code>## # A tibble: 5 × 8
##   var1  var2    cor statistic        p conf.low conf.high method 
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
## 1 mpg   disp  -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson
## 2 mpg   hp    -0.78     -6.74 1.79e- 7  -0.885     -0.586 Pearson
## 3 mpg   drat   0.68      5.10 1.78e- 5   0.436      0.832 Pearson
## 4 mpg   wt    -0.87     -9.56 1.29e-10  -0.934     -0.744 Pearson
## 5 mpg   qsec   0.42      2.53 1.71e- 2   0.0820     0.670 Pearson</code></pre>
<pre class="r"><code># Pairwise correlation test between all variables
mydata %&gt;% cor_test(method = &quot;pearson&quot;)</code></pre>
<pre><code>## # A tibble: 36 × 8
##    var1  var2    cor statistic        p conf.low conf.high method 
##    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 mpg   mpg    1       Inf    0          1          1     Pearson
##  2 mpg   disp  -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson
##  3 mpg   hp    -0.78     -6.74 1.79e- 7  -0.885     -0.586 Pearson
##  4 mpg   drat   0.68      5.10 1.78e- 5   0.436      0.832 Pearson
##  5 mpg   wt    -0.87     -9.56 1.29e-10  -0.934     -0.744 Pearson
##  6 mpg   qsec   0.42      2.53 1.71e- 2   0.0820     0.670 Pearson
##  7 disp  mpg   -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson
##  8 disp  disp   1       Inf    0          1          1     Pearson
##  9 disp  hp     0.79      7.08 7.14e- 8   0.611      0.893 Pearson
## 10 disp  drat  -0.71     -5.53 5.28e- 6  -0.849     -0.481 Pearson
## # … with 26 more rows</code></pre>
</div>
<div id="correlation-matrix" class="section level3">
<h3>Correlation matrix</h3>
<pre class="r"><code># Compute correlation matrix
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cor.mat &lt;- mydata %&gt;% cor_mat()
cor.mat</code></pre>
<pre><code>## # A tibble: 6 × 7
##   rowname   mpg  disp    hp   drat    wt   qsec
## * &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 mpg      1    -0.85 -0.78  0.68  -0.87  0.42 
## 2 disp    -0.85  1     0.79 -0.71   0.89 -0.43 
## 3 hp      -0.78  0.79  1    -0.45   0.66 -0.71 
## 4 drat     0.68 -0.71 -0.45  1     -0.71  0.091
## 5 wt      -0.87  0.89  0.66 -0.71   1    -0.17 
## 6 qsec     0.42 -0.43 -0.71  0.091 -0.17  1</code></pre>
<pre class="r"><code># Show the significance levels
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cor.mat %&gt;% cor_get_pval()</code></pre>
<pre><code>## # A tibble: 6 × 7
##   rowname      mpg     disp           hp       drat        wt       qsec
##   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 mpg     0        9.38e-10 0.000000179  0.0000178  1.29e- 10 0.0171    
## 2 disp    9.38e-10 0        0.0000000714 0.00000528 1.22e- 11 0.0131    
## 3 hp      1.79e- 7 7.14e- 8 0            0.00999    4.15e-  5 0.00000577
## 4 drat    1.78e- 5 5.28e- 6 0.00999      0          4.78e-  6 0.62      
## 5 wt      1.29e-10 1.22e-11 0.0000415    0.00000478 2.27e-236 0.339     
## 6 qsec    1.71e- 2 1.31e- 2 0.00000577   0.62       3.39e-  1 0</code></pre>
<pre class="r"><code># Replacing correlation coefficients by symbols
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cor.mat %&gt;%
  cor_as_symbols() %&gt;%
  pull_lower_triangle()</code></pre>
<pre><code>##   rowname mpg disp hp drat wt qsec
## 1     mpg                         
## 2    disp   *                     
## 3      hp   *    *                
## 4    drat   +    +  .             
## 5      wt   *    *  +    +        
## 6    qsec   .    .  +</code></pre>
<pre class="r"><code># Mark significant correlations
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cor.mat %&gt;%
  cor_mark_significant()</code></pre>
<pre><code>##   rowname       mpg      disp        hp      drat    wt qsec
## 1     mpg                                                   
## 2    disp -0.85****                                         
## 3      hp -0.78****  0.79****                               
## 4    drat  0.68**** -0.71****   -0.45**                     
## 5      wt -0.87****  0.89****  0.66**** -0.71****           
## 6    qsec     0.42*    -0.43* -0.71****     0.091 -0.17</code></pre>
<pre class="r"><code># Draw correlogram using R base plot
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cor.mat %&gt;%
  cor_reorder() %&gt;%
  pull_lower_triangle() %&gt;% 
  cor_plot()</code></pre>
<p><img src="useful_packages___rstatix_files/figure-html/unnamed-chunk-9-1.png" width="384" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
